rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Pacientes: somente o criador (userId) pode criar/ler/editar/deletar
    match /pacientes/{docId} {
      allow create: if request.auth != null
                    && request.resource.data.userId == request.auth.uid;

      allow read, update, delete: if request.auth != null
                                  && resource.data.userId == request.auth.uid;
    }

    // Registros de insulina: mesmo comportamento
    match /registros_insulina/{docId} {
      allow create: if request.auth != null
                    && request.resource.data.userId == request.auth.uid;

      allow read, update, delete: if request.auth != null
                                  && resource.data.userId == request.auth.uid;
    }

    // Adicione outras coleções aqui conforme necessário.
  }
}
